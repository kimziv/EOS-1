<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.6.0 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>How to write contracts - BlockchainTranslator</title>




<meta name="description" content="  原文链接：https://eosio.github.io/eos/group__contractdev.html  翻译：区块链中文字幕组 - 张奎 胡亮  审核：区块链中文字幕组 - 梓岑">




<meta name="author" content="BlockchainTranslator  ">

<meta property="og:locale" content="zh_CN">
<meta property="og:site_name" content="BlockchainTranslator  ">
<meta property="og:title" content="How to write contracts">


  <link rel="canonical" href="http://localhost:4000/How-To-Write-Contracts/">
  <meta property="og:url" content="http://localhost:4000/How-To-Write-Contracts/">



  <meta property="og:description" content="  原文链接：https://eosio.github.io/eos/group__contractdev.html  翻译：区块链中文字幕组 - 张奎 胡亮  审核：区块链中文字幕组 - 梓岑">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-08-19T00:00:00+08:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "BlockchainTranslator Group",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>







<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="BlockchainTranslator   Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/">BlockchainTranslator  </a>
        <ul class="visible-links">
          
        </ul>
        <button type="button">
          <span class="visually-hidden">切换菜单</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    



<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">BlockchainTranslator  </h3>
    
      <p class="author__bio" itemprop="description">
        In Blockchain We Trust.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">关注</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">China</span>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/BlockchainTranslator" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="How to write contracts">
    <meta itemprop="description" content="  原文链接：https://eosio.github.io/eos/group__contractdev.html  翻译：区块链中文字幕组 - 张奎 胡亮  审核：区块链中文字幕组 - 梓岑">
    <meta itemprop="datePublished" content="August 19, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">How to write contracts
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  2 分钟读完
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <blockquote>
  <p>原文链接：<a href="https://eosio.github.io/eos/group__contractdev.html">https://eosio.github.io/eos/group__contractdev.html</a></p>

  <p>翻译：区块链中文字幕组 - <a href="https://github.com/byzhangkui">张奎</a> <a href="https://github.com/gumoon">胡亮</a></p>

  <p>审核：区块链中文字幕组 - <a href="https://yoyow.org/">梓岑</a></p>
</blockquote>

<h1 id="how-to-write-contracts-eos-如何为-eosio-编写智能合约">How To Write Contracts EOS 如何为 EOS.IO 编写智能合约</h1>

<p>Introduction to writing contracts for EOS.IO.</p>

<p>EOS.IO 合约编写简介。</p>

<h2 id="modules--模块">Modules  模块</h2>

<p><a href="#">Database API</a></p>

<p>APIs that store and retreive data on the blockchain</p>

<p>在区块链上存储和检索数据的接口。</p>

<p><a href="#">Math API</a></p>

<p>Defines common math functions.</p>

<p>定义常用数学函数。</p>

<p><a href="#">Message API</a></p>

<p>Define API for querying message properties.</p>

<p>定义消息属性查询接口。</p>

<p><a href="#">Console API</a></p>

<p>Enables applications to log/print text messages.</p>

<p>支持应用程序记录/打印文本消息。</p>

<p><a href="#">Token API</a></p>

<p>Defines the ABI for interfacing with standard-compatible token messages and database tables.</p>

<p>定义ABI（应用系统二进制接口），实现与标准兼容的 token 消息及数据库表之间的交互</p>

<p><a href="#">Builtin Types</a></p>

<p>Specifies typedefs and aliases.</p>

<p>指定类型定义和别名。</p>

<h2 id="detailed-description-详细说明">Detailed Description 详细说明</h2>
<h3 id="background-背景">Background 背景</h3>
<p>EOS.IO contracts (aka applications) are deployed to a blockchain as pre-compiled Web Assembly (aka WASM). WASM is compiled from C/C++ using LLVM and clang, which means that you will require knowledge of C/C++ in order to develop your blockchain applications. While it is possible to develop in C, we strongly recommend that all developers use the EOS.IO C++ API which provides much stronger type safety and is generally easier to read.</p>

<p>EOS.IO 合约（应用程序）以预编译的 Web Assembly（WASM）形式部署在区块链上。WASM 使用 C/C++ 编写，通过 LLVM 和 clang 编译，这意味着，开发 EOS.IO 智能合约首先需要具备 C/C++ 基础。不过，虽然可以用 C 语言来开发，但我们强烈推荐使用C++ 接口。C++ 接口是强类型安全性的 ，并且也更容易阅读。</p>

<h3 id="application-structure-应用程序结构">Application Structure 应用程序结构</h3>

<p>EOS.IO applications are designed around event (aka message) handlers that respond to user actions. For example, a user might transfer tokens to another user. This event can be processed and potentially rejected by the sender, the receiver, and the currency application itself.</p>

<p>EOS.IO 应用程序是围绕响应用户行为的事件（消息）处理来设计的。如用户间的代币转账交易会触发一个事件。这个事件可以被发送方，接收方或者当前应用程序本身进行处理或者拒绝。</p>

<p>As an application developer you get to decide what actions users can take and which handlers may or must be called in response to those events.</p>

<p>开发者需要决定用户可以触发哪些行为，以及哪些处理函数应该或者必须被调用，用以作为对这些事件的响应。</p>

<h4 id="entry-points-入口点">Entry Points 入口点</h4>
<p>EOS.IO applications have a apply which is like main in traditional applications:</p>

<p>EOS.IO 应用程序提供 apply 方法作为入口点，类似传统应用程序的 main 方法：</p>

<pre><code class="language-C">extern "C" {
   void init();
   void apply( uint64_t code, uint64_t action );
}
</code></pre>

<p>main is give the arguments code and action which uniquely identify every event in the system. For example, code could be a currency contract and action could be transfer. This event (code,action) may be passed to several contracts including the sender and receiver. It is up to your application to figure out what to do in response to such an event.</p>

<p>apply 方法包含 code 和 action 两个参数，在系统内通过这两个参数可唯一标识每个事件。例如，code 可以是一个现金合约，而 action 就是转移的行为。这个事件（code，action）可以被传递到包括发送者和接收者的多个合约中。如何响应一个事件, 由应用程序确定。</p>

<p>init is another entry point that is called once immediately after loading the code. It is where you should perform one-time initialization of state.</p>

<p>init 是另外一个程序入口点，在加载代码后会被立即调用，且只被调用一次的。在这里你可以实现一次性的状态初始化。</p>

<h4 id="example-apply-entry-handler-入口处理函数的示例">Example Apply Entry Handler 入口处理函数的示例</h4>

<p>Generally speaking, you should use your entry handler to dispatch events to functions that implement the majority of your logic and optionally reject events that your contract is unable or unwilling to accept.</p>

<p>一般来说，你应该使用入口处理函数去分发事件到对应的方法。这些方法实现主要的处理逻辑，或者选择性地拒绝合约不识别或者不应该接受的事件。</p>

<pre><code class="language-C">extern "C" {
   void apply( uint64_t code, uint64_t action ) {
      if( code == N(currency) ) {
         if( action == N(transfer) )
            currency::apply_currency_transfer( currentMessage&lt; currency::Transfer &gt;() );
      } else {
         assert( false, "rejecting unexpected event" );
      }
   }
}
</code></pre>

<blockquote>
  <p><strong>Note  说明</strong></p>

  <p>When defining your entry points it is required that they are placed in an extern “C” code block so that c++ name mangling<sup id="fnref:footnote"><a href="#fn:footnote" class="footnote">1</a></sup> does not get applied to the function.</p>
</blockquote>

<blockquote>
  <p>当你定义入口点时，需要将代码放在 extern “C” 代码块中，使得 C++ 名字修饰<sup id="fnref:footnote:1"><a href="#fn:footnote" class="footnote">1</a></sup>不会应用到该方法上。</p>
</blockquote>

<div class="footnotes">
  <ol>
    <li id="fn:footnote">
      <p><em>name mangling</em> 名字修饰，又译做名字粉碎、名字重整，是编译器在函数、结构体、类或其它的数据类型的名字中编码附加信息一种方法，以消除二义性。应用场景如区分重载函数，标识调用约定等。&nbsp;<a href="#fnref:footnote" class="reversefootnote">&#8617;</a>&nbsp;<a href="#fnref:footnote:1" class="reversefootnote">&#8617;<sup>2</sup></a></p>
    </li>
  </ol>
</div>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> 更新时间:</strong> <time datetime="2017-08-19T00:00:00+08:00">August 19, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">分享</h4>
  

  <a href="https://twitter.com/intent/tweet?text=How+to+write+contracts%20http%3A%2F%2Flocalhost%3A4000%2FHow-To-Write-Contracts%2F" class="btn btn--twitter" title="分享 Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FHow-To-Write-Contracts%2F" class="btn btn--facebook" title="分享 Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2FHow-To-Write-Contracts%2F" class="btn btn--google-plus" title="分享 Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2FHow-To-Write-Contracts%2F" class="btn btn--linkedin" title="分享 LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="#" class="pagination--pager disabled">向前</a>
    
    
      <a href="http://localhost:4000/EOS-Command-Line-Client/" class="pagination--pager" title="Eos command line client
">向后</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">猜您还喜欢</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/README/" rel="permalink">Readme
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  少于 1 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">简介

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/the-message-is-the-medium/" rel="permalink">The Message Is The Medium
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  14 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">The Message Is The Medium  信息即媒介

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/EOS-White-Paper-Digest/" rel="permalink">Eos White Paper Digest
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  3 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">﻿# EOS White Paper Digest 对EOS白皮书的摘要

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/a-proof-of-stake-design-philosophy/" rel="permalink">A Proof Of Stake Design Philosophy
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  9 分钟读完
</p>
    
    <p class="archive__item-excerpt" itemprop="description">A Proof of Stake Design Philosophy–权益证明设计哲学

</p>
  </article>
</div>
        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>关注:</strong></li>
    
    
    
    
      <li><a href="http://github.com/BlockchainTranslator"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 BlockchainTranslator Group. 技术来自于 <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="http://localhost:4000/assets/js/main.min.js"></script>






  </body>
</html>